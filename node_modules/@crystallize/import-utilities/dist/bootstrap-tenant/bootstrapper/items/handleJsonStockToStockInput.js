"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.handleJsonStockToStockInput = void 0;
function handleJsonStockToStockInput({ jsonStock, existingProductVariantStockLocations, }) {
    if (typeof jsonStock === undefined && !existingProductVariantStockLocations) {
        return undefined;
    }
    const stockVariants = existingProductVariantStockLocations || [];
    if (jsonStock && typeof jsonStock === 'object') {
        const p = jsonStock;
        Object.keys(jsonStock).forEach((identifier) => {
            const existingEntry = stockVariants.find((i) => i.identifier === identifier);
            if (existingEntry) {
                existingEntry.stock = p[identifier];
            }
            else {
                stockVariants.push({
                    identifier,
                    stock: p[identifier],
                });
            }
        });
    }
    else if (typeof jsonStock !== 'undefined') {
        const defaultStock = stockVariants.find((i) => i.identifier === 'default');
        if (defaultStock) {
            defaultStock.stock = jsonStock;
        }
        else {
            stockVariants.push({
                identifier: 'default',
                stock: jsonStock,
            });
        }
    }
    return stockVariants.map(({ identifier, stock, meta }) => ({
        identifier,
        stock: stock !== null && stock !== void 0 ? stock : 0,
        meta: meta || [],
    }));
}
exports.handleJsonStockToStockInput = handleJsonStockToStockInput;
